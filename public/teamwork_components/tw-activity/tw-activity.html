<link rel="import" href="../../bower_components/polymer/polymer.html">
<link rel="import" href="../../bower_components/core-icons/core-icons.html">
<link rel="import" href="../../bower_components/core-menu/core-menu.html">
<link rel="import" href="../../bower_components/paper-dropdown/paper-dropdown.html">
<link rel="import" href="../../bower_components/paper-shadow/paper-shadow.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-dialog-transition.html">
<link rel="import" href="../../bower_components/paper-dialog/paper-action-dialog.html">
<link rel="import" href="../../bower_components/paper-item/paper-item.html">
<link rel="import" href="../../bower_components/paper-menu-button/paper-menu-button.html">
<link rel="import" href="../../bower_components/paper-icon-button/paper-icon-button.html">


<polymer-element name="tw-activity"  attributes="activityId">
    <template>
        <style>
            :host {
                display: block;
                position: relative;
                font-weight: 300;
                width: 100%;
                background-color: #2196F3;
                heigth: 100%;
            }

            .activity {
                bottom: 15px;
                height: 90%;
            }

            .activity-header {
                position: relative;
                margin-left: 25px;
            }

            .state-list {
                padding-top: 30px;
                padding-bottom: 30px;
            }

            .separator {
                color: #DDD;
                margin: 0px;
            }

            #new-state-btn {
                position: fixed;
                bottom: 30px;
                right: 30px;
            }

            #edit-activity-btn {
                position: absolute;
                top: 37px;
                right: 30px;
                z-index: 100;
            }
        </style>

        <div class="activity" layout vertical fit>
            <div class="activity-header" layout horizontal left>
                <core-tooltip position="right">
                    <span flex>
                        <content select="h2"></content>
                    </span>
                    <div tip>
                        <content select="h3"></content>
                    </div>
                </core-tooltip>
            </div>
            <hr class="separator">
            <paper-fab id="edit-activity-btn" icon="create" class="blue" title="edit" on-click="{{toggleEditActivty}}"></paper-fab>
            <core-collapse  id="editActivityForm">
                <content select="event-form-container"></content>
                <hr class="separator">
            </core-collapse>
            <div class="state-list" horizontal layout left>
                <content></content>
            </div>
            <paper-fab id="new-state-btn" icon="add" class="blue" title="create" on-click="{{openNewListDialog}}"></paper-fab>
        </div>

        <paper-action-dialog transition="core-transition-fade" heading="Add a state" id="newListDialog">
            <p>
            <paper-input-decorator label="State label" error="We need label!"
                                   floatingLabel class="input-light">
                <input is="core-input" id="newListLabel" type="text" value="{{newListLabel}}" required>
            </paper-input-decorator>
            </p>
            <paper-button dismissive>Cancel</paper-button>
            <paper-button affirmative autofocus on-click="{{addList}}">Create</paper-button>
        </paper-action-dialog>

    </template>
    <script>
        Polymer({
            eventDelegates: {
                'save-activity': 'toggleEditActivty'
            },
            openNewListDialog: function () {
                console.log("Click on New List Button.");
                this.$.newListDialog.toggle();
            },
            toggleEditActivty: function () {
                this.$.editActivityForm.toggle();
            },
            addList: function () {
                console.log("Fire event add-list : " + this.activityId + " - label : " + this.newListLabel);
                this.fire('add-list', {activityId: this.activityId, listLabel: this.newListLabel});
                this.newListLabel = "";
            },
            deleteActivity: function () {
                console.log("Fire event delete-activity : " + this.activityId);
                this.fire('delete-activity', {activityId: this.activityId});
            }
        });
    </script>
</polymer-element>
